<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Game</title>
    <style>
        body {
            margin: 30px auto;
            text-align: center;
            color: #999;
        }

        #board canvas {
            border: 1px solid #333;
            background-color: #000;
            -webkit-box-shadow: 0px 0px 24px 0px rgba(0, 0, 0, 1);
            -moz-box-shadow: 0px 0px 24px 0px rgba(0, 0, 0, 1);
            box-shadow: 0px 0px 24px 0px rgba(0, 0, 0, 1);
            border-radius: 10px;
        }
    </style>
</head>

<body>
    <div id="board">
        <canvas width="640" height="480"></canvas>
    </div>
    <script>
        class KeyControls {
            constructor() {
                this.keys = {};
                document.addEventListener(
                    'keydown',
                    e => {
                        if ([37, 38, 39, 40].indexOf(e.which) >= 0) {
                            e.preventDefault();
                        }
                        this.keys[e.which] = true;
                    },
                    false,
                );

                document.addEventListener(
                    'keyup',
                    e => {
                        this.keys[e.which] = false;
                    },
                    false,
                );
            }

            get action() {
                return this.keys[32];
            }

            get x() {
                if (this.keys[37] || this.keys[65]) return -1;
                if (this.keys[39] || this.keys[68]) return 1;
                return 0;
            }

            get y() {
                if (this.keys[38] || this.keys[87]) return -1;
                if (this.keys[40] || this.keys[83]) return 1;
                return 0;
            }
        }

        const controls = new KeyControls

        const canvas = document.querySelector('#board canvas');
        const ctx = canvas.getContext('2d');

        const { width: w, height: h } = canvas;

        let rectW = 50;
        let rectH = 50;
        let x = w / 2 - rectW / 2;
        let y = h / 2 - rectH / 2;
        let color = 0;

        function loop() {
            requestAnimationFrame(loop)
            x += controls.x;
            y += controls.y;

            // We will be able to change the color with the action button
            if (controls.action) {
                color += 10;
                if (color > 360) {
                    color -= 360;
                }
            }

            ctx.fillStyle = 'black'
            ctx.fillRect(0, 0, w, h)

            ctx.fillStyle = `hsl(${color}, 50%, 50%)`;
            ctx.fillRect(x, y, 50, 50);
        }

        requestAnimationFrame(loop)




    </script>
</body>

</html>